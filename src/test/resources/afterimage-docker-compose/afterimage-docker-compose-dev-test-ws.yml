services:
  afterimage-db:
    image: "redis:8.0.0"
    hostname: localhost
    ports:
      - "6381:6379"
    #    environment:
    #      - "REDIS_ARGS=--appendonly yes"
    healthcheck:
      test: [ "CMD", "redis-cli" ,"ping", "afterimage-db" ]
      retries: 10
      interval: 3s
      timeout: 30s
    networks:
      docker-network:
  afterimage-app:
    image: afterimage-nostr-reputation-relay:1.0.0
    ports:
      - "5557:5556"
    depends_on:
      afterimage-db:
        condition: service_healthy
    networks:
      docker-network:
    environment:
      superconductor.auth.active: false
      SPRING_PROFILES_ACTIVE: dev_ws      
volumes:
  afterimage-db:
    driver: local
networks:
  docker-network:
    driver: bridge
